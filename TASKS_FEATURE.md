# Функционал создания задач

## Описание

Добавлена полная функциональность создания задач в CRM системе с drag & drop и модальными окнами.

## Компоненты

### 1. CreateTaskDialog
**Путь:** `/components/tasks/CreateTaskDialog.tsx`

Модальное окно для создания новой задачи с полями:
- **Название задачи** (обязательно)
- **Дедлайн** (обязательно, date picker)
- **Исполнитель** (обязательно, текстовое поле)
- **Приоритет** (Низкий/Средний/Высокий)
- **Тип задачи** (Клиент/Сделка)
- **Прогресс** (выполнено / всего задач)
- **Иконка** (emoji, max 2 символа)

### 2. TaskBoardView
**Путь:** `/components/tasks/TaskBoardView.tsx`

Kanban доска с drag & drop функционалом:
- Перетаскивание задач между колонками
- Кнопки создания задачи в заголовках колонок
- Кнопка "Добавить задачу" в конце каждой колонки
- Автоматическое обновление счетчиков задач

### 3. TasksPage
**Путь:** `/app/(pages)/tasks/page.tsx`

Главная страница задач с:
- Управлением состоянием задач
- Интеграцией CreateTaskDialog
- Поддержкой 3 видов отображения (Карточки/Доска/Список)

## Как использовать

### Создание задачи

**Способ 1: Через кнопку в шапке**
1. Нажмите кнопку "Создать задачу" в правом верхнем углу
2. Заполните форму
3. Нажмите "Создать задачу"

**Способ 2: Через колонку в доске**
1. В виде "Доска" нажмите "+ Название колонки" или "Добавить задачу"
2. Заполните форму
3. Задача автоматически добавится в выбранную колонку

### Drag & Drop

1. Наведите на задачу в доске
2. Зажмите левую кнопку мыши
3. Перетащите задачу в другую колонку
4. Отпустите кнопку

## Структура данных Task

```typescript
interface Task {
  id: string                    // Генерируется автоматически
  title: string                 // Название задачи
  deadline: string              // Дедлайн (формат: 'YYYY-MM-DD')
  assignee: {
    name: string                // Имя исполнителя
    avatar: string              // Путь к аватару
  }
  priority: 'low' | 'medium' | 'high'  // Приоритет
  progress: {
    completed: number           // Выполнено задач
    total: number               // Всего задач
  }
  type: 'client' | 'deal'      // Тип задачи
  status: TaskStatus            // Статус (колонка)
  icon: string                  // Emoji иконка
}
```

## Состояния (TaskStatus)

- `new` - Новые
- `in_progress` - В работе  
- `completed` - Завершенные
- `overdue` - Просроченные

## Колонки в Board View

1. **В работе** (in_progress) - желтый счетчик
2. **Завершенные** (completed) - желтый счетчик
3. **Просроченные** (overdue) - желтый счетчик

## Возможности расширения

### Добавление API интеграции

Замените генерацию ID и добавьте API calls:

```typescript
const handleCreateTask = async (newTask: Omit<Task, 'id'>) => {
  // Отправка на backend
  const response = await fetch('/api/tasks', {
    method: 'POST',
    body: JSON.stringify(newTask)
  })
  const task = await response.json()
  
  // Обновление state
  setTasks([...tasks, task])
}
```

### Добавление редактирования задач

Создайте `EditTaskDialog` аналогично `CreateTaskDialog` и добавьте функцию обновления.

### Добавление удаления задач

Добавьте кнопку удаления в карточку задачи и функцию:

```typescript
const handleDeleteTask = (taskId: string) => {
  setTasks(tasks.filter(t => t.id !== taskId))
}
```

## Валидация

В CreateTaskDialog встроена базовая валидация:
- Проверка на заполнение обязательных полей
- Alert при попытке создать задачу без данных

Для более сложной валидации можно использовать библиотеки типа `zod` или `yup`.
